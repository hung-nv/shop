"use strict";
var UINestable = function() {
    var t, h, url, hostName, menuGroup;
    url = window.location;
    menuGroup = $('#list-menu-item').val();

    if(url.port) {
        hostName = url.protocol + '//' + url.hostname + ':' + url.port
    } else {
        hostName = url.protocol + '//' + url.hostname;
    }
    t = function(t) {
        var e = t.length ? t : $(t.target),
            a = e.data("output");
        window.JSON ? a.val(window.JSON.stringify(e.nestable("serialize"))) : a.val("JSON browser support required for this demo.");
    };
    
    h = function (h) {
        var e = h.length ? h : $(h.target),
            a = e.data("output");
        window.JSON ? a.val(window.JSON.stringify(e.nestable("serialize"))) : a.val("JSON browser support required for this demo.");

        $.ajax({
            type: "post",
            dataType: 'json',
            url: hostName + '/api/update-sort',
            data: {data: e.nestable("serialize"), menu_group: menuGroup},
            success: function(result) {
                // $("#nestable_list_2").load(hostName + "/api/get-menu");
            },
            error: function() {
            }
        });
    }

    return {
        init: function() {
            $("#nestable_list_2").nestable({
                group: 1
            }).on("change", h), t($("#nestable_list_2").data("output", $("#nestable_list_2_output")));
        }
    }
}();
jQuery(document).ready(function() {
    UINestable.init()
});